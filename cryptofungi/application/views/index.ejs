<!DOCTYPE html>
<html>
  <head>
    <title><%= title %></title>
    <link rel='stylesheet' href='/stylesheets/style.css' />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>
  </head>
  <body>
    <h1><%= title %></h1>
    <p> <%= username %>님 환영합니다.</p>
    <a href="/logout">로그아웃하기</a>    
    <br><br>
    <% if (result == ""){ %>
      <a href="/createFungus" class="btn btn-primary">태초버섯생성</a>
    <% } else { %>
      <p>보유 버섯 리스트</p>      
      <% const fungi = JSON.parse(result) %>
      <div class="row row-cols-auto">
        <% for (var i = 0; i < fungi.length; i++) { %>
          <% var date = new Date(fungi[i].ReadyTime * 1000 + 9 * 60 * 60 *1000) %>      
          <div class="col">
            <div class="card" style="width: 18rem;">
              <div class="card-body">
                <h5 class="card-title"><%= fungi[i].Name %></h5>
                <p class="card-text">버섯ID : <%= fungi[i].FungusId %></p>
                <p class="card-text">DNA : <%= fungi[i].Dna %></p>
                <p class="card-text">증식가능시간 : <%= date.toLocaleTimeString("ko-KR") %></p>
                <p class="card-text">소유주 : <%= fungi[i].Owner %></p>
              </div>
              <div class="accordion" id="accordionExample">
                <div class="accordion-item">
                  <% collapseOneID = "collapseOne"+ fungi[i].FungusId %>
                  <% collapseOneTarget = "#collapseOne"+ fungi[i].FungusId %>                  
                  <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="<%= collapseOneTarget %>" aria-expanded="false" aria-controls="<%= collapseOneID %>" >
                      버섯증식하기
                    </button>
                  </h2>                  
                  <div id="<%= collapseOneID %>" class="accordion-collapse collapse" data-bs-parent="#accordionExample">
                    <div class="accordion-body">
                      <div class="card-header">
                        <h5 >버섯 증식하기</h5>
                        <form action="/createFungus/feed" method="post">
                          <input type="hidden" name="fungusid" class="form-control" value=<%= fungi[i].FungusId %>><br>
                          <label>먹이ID : </label>
                          <input type="text" name="feedid" class="form-control"><br>
                          <input type="submit" value="증식하기" class="btn btn-primary" style="width: 100%;">
                        </form>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="accordion-item">
                  <% collapseOneID = "collapsetwo"+ fungi[i].FungusId %>
                  <% collapseOneTarget = "#collapsetwo"+ fungi[i].FungusId %>    
                  <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="<%= collapseOneTarget %>" aria-expanded="false" aria-controls="<%= collapseOneID %>" >
                      버섯거래하기
                    </button>
                  </h2>
                  <div id="<%= collapseOneID %>" class="accordion-collapse collapse" data-bs-parent="#accordionExample">
                    <div class="accordion-body">
                      <div class="card-header">
                        <h5>버섯 거래하기</h5>
                        <form action="/createFungus/transfer" method="post">
                          <input type="hidden" name="fungusid" class="form-control" value=<%= fungi[i].FungusId %>><br>
                          <input type="hidden" name="from" class="form-control" value=<%= fungi[i].Owner %>><br>
                          <label>버섯구매자ID : </label>
                          <input type="text" name="to" class="form-control"><br>
                          <input type="submit" value="버섯 보내기" class="btn btn-warning" style="width: 100%;">
                        </form>
                      </div>
                    </div>
                  </div>
                </div>               
              </div>


              
              







            </div>
          </div>
        <% } %>
      </div>      
    <% } %>


  </body>
</html>
